"use strict";var proxymity=function(e){function n(e){return Array.prototype.slice.call(e||[])}function t(e,t){return n(e).forEach(t)}function r(e){return"function"==typeof e}function o(e){return"string"==typeof e}function i(e){return"boolean"==typeof e}function a(e){return"object"==typeof e}function u(e){return Object.getOwnPropertyNames(e)}function c(e,n){var t,r,o;return void 0===n||e>n?(r=e,t=n||0):(t=e,r=n),o=r-t,Math.round(Math.random()*(o+.9998)-.4999)+t}var s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";function f(e=16){for(var n=s[c(51)],t=1;t<e;t++)n+=s[c(62)];return n}function l(e,n){var r=u(n);for(var o in e)n[o]=e[o],r.splice(r.indexOf(o),1);t(r,function(e,t){e||"length"===t||delete n[t]}.bind(null,Array.isArray(n)))}var v=function(){var e=f(c(32,48)),n=!1,r=[];return window.addEventListener("message",function(o){if(o.data===e){o.stopPropagation();var i=r;e=f(c(32,48)),n=!1,r=[],t(i,function(e){e()})}}),function(t){n||(window.postMessage(e,"*"),n=!0),r.push(t)}}();var p={objectify:function(){if(Array.isArray(this))var e=[];else e={};var n=u(this);for(var t in n){var r=n[t];a(this[r])&&this[r].objectify?e[r]=this[r].objectify():e[r]=this[r]}return e},stringify:function(){var e=n(arguments);return e.unshift(p.objectify.call(this)),JSON.stringify.apply(JSON,e)},toString:function(){return u(this).length?p.stringify.call(this):""}};p[Symbol.toPrimitive]=function(e){return"number"==e?u(this).length:"string"==e?p.toString.call(this):!!u(this).length};var h=Object.create(Array.prototype);t(u(p),function(e){h[e]=p[e]});var d=f(c(32,48)),y=f(c(32,48)),g=f(c(32,48)),m=f(c(32,48));function b(n,r,o,i,a,u){var s=n.textContent,l=[];if(s.replace(/\{\:([\s\S]*?)\:\}(\|(\s|\n)*\{[\s\S]*?\}(\s|\n)*\|)?/g,function(e,n,t){l.push({drop:e,run:n,on:t&&t.replace(/^\|[\s\n]*\{|\}[\s\n]*\|$/g,"").split(/\}[\s\n]*\,[\s\n]*\{/g)})}),l.length){var v=function(){var r,i;n.textContent=(r=s,i=o,t(l,function(n){r=r.replace(n.drop,function(){try{return e.call(i,n.run)}catch(e){return console.error("failed to render expression ["+n.run+"]",e),""}})}),r)};t(l,function(e){f(c(32,48));if(e.on){t(e.on,function(e){var n=v.bind(null);n.to="del";var t=v.bind(null);t.to="set",w(o,i,r,a,function(){return e},[n,t],u)})}else u.push(r.watch("asyncstart",v)),v()})}}var k=Object.create(Array.prototype);function w(n,t,r,o,i,a,u){var c=i();e.call(n,"this."+t+("["===c[0]?"":".")+c);var s=r.last("get").value,f={};for(var l in a){var v=a[l].to+":"+s;u.push(f[a[l].to]=r.watch(v,a[l])),a[l](r.next(v)||r.last(v))}u.push(f[s]=r.watch("remap:"+s,function(){for(var e in f){f[e]();var c=u.indexOf(f[e]);c>-1&&u.splice(c,1)}w(n,t,r,o,i,a,u)}))}function O(e,n){t(e,function(e,t,r){n(e),O(e.childNodes,n)})}k.appendTo=function(e){if(o(e))return k.appendTo.call(this,document.querySelector(e));var n=e;return t(this,function(e){n.appendChild(e)}),this},k.detach=function(){return t(this,function(e){var n=e.parentElement;n&&n.removeChild(e)}),this};var x=f(c(32,48));function A(e,n,r,o){o.source.length;var i="set:"+e.last("get").value,a=function(i){if(void 0!==i){var a,u,c,s,f=o.outputList.indexOf(o.insertBefore),l=o.outputList.indexOf(o.insertAfter),v=o.outputList,p=o.insertBefore.parentNode,h=(a=v.slice(l+1,f),u=o.key,c=[],t(a,function(e){var n=e[u];c[n]=c[n]||[],c[n].push(e)}),c);if(h.length<o.source.length)for(;h.length!==o.source.length;){var d=o.elements.map(function(e){return e.cloneNode(!0)});O(d,function(e){Object.defineProperty(e,o.key,{configurable:!0,enumerable:!1,get:function(e){return e}.bind(e,h.length)})}),N(d,n,e,r),p&&t(d,function(e){p.insertBefore(e,o.insertBefore)}),o.onClone&&t(d,function(e){e instanceof HTMLElement&&o.onClone(e)}),v.splice.apply(v,[f,0].concat(d)),f+=d.length,h.push(d)}else if(h.length>o.source.length)for(;h.length!==o.source.length;){var y=h.pop();t(y,function(e){v.splice(v.indexOf(e),1),e.parentNode&&e.parentNode.removeChild(e)}),O(s=y,function(e){e.dispatchEvent(new CustomEvent(x))}),t(s,function(e){e.parentNode&&e.parentNode.removeChild(e)})}}};e.watch("asyncstart",function(e){e.payload.hasOwnProperty(i)&&a(e.payload[i])}),a(e.next(i)||e.last(i))}function N(u,s,v,p){if(o(u)){var h=document.createElement("template");return h.innerHTML=u.trim(),N(h.content.childNodes,s,v,p)}if(u instanceof NodeList||u instanceof Array&&u.reduce(function(e,n){return e&&n instanceof Node},!0)){var y,g=[],m=n(u),O=function(e){if(y)throw new error("Improper usage of key(string).in(array): key(string) cannot be nested on the same level");return y={key:e},O};return O.in=function(e){if(!y)throw new Error("Improper usage of key(string).in(array): key(string) not called");if(y.source)throw new Error("Improper usage of key(string).in(array): in(array) called before key");if(!Array.isArray(e)||!e[d])throw new Error("Improper usage of key(string).in(array): in(array) is not provided with a proxified array");y.source=e,y.elements=[]},O.end=function(e){if(!(y&&y.key&&y.source&&y.elements&&y.elements.length))throw new Error("Improper usage of key.end([onClone]): key(string).in(array) is not called properly prior to calling key.end([onClone])");y.outputList=m,y.insertBefore=y.elements.pop(),r(e)&&(y.onClone=e),g.push.apply(g,y.elements);for(var n=m.length-1;n>=0;n--)if(-1!==g.indexOf(m[n])){var t=m[n].parentNode;t&&t.removeChild(m[n]),m.splice(n,1)}y.insertAfter=y.insertBefore.previousSibling,A(v,s,p,y),y=void 0},t(m,function(n){if(y&&y.elements&&y.elements.push(n),n instanceof Comment&&"foreach:"===n.textContent.trim().substr(0,8).toLowerCase()&&(N(n,s,v,p),e.call(n,n.textContent,{key:O}),y&&(!y.key||!y.source||!y.elements)))throw new Error("Improper usage of key(string).in(array): in(array) not called in conjunction with key")}),t(m,function(e){e[p]!==s&&N(e,s,v,p)}),Object.setPrototypeOf(m,k)}if(u instanceof Node){var E=u,j=[];Object.defineProperty(E,p,{configurable:!0,get:function(){return s},set:function(e){a(e)&&l(e,s)}}),j.push(function(){delete E[p]}),E instanceof CharacterData?b(E,v,E,p,s,j):N(E.childNodes,s,v,p),t(E.attributes,function(n){if(b(n,v,E,p,s,j),!("name"!==n.name||"INPUT"!==E.nodeName&"TEXTAREA"!==E.nodeName&"SELECT"!==E.nodeName)){var r=function(e){try{var n=e.value.toString();n!==E.value&&(E.value=n)}catch(e){E.value=null}},o=function(e){a(e)&&(E.value=null)},u="value",l=E.type.toLowerCase();"number"===l||"range"===l?(u="valueAsNumber",r=function(e){e&&"number"==typeof e.value?"number"==typeof e.value&&e.value!==E.valueAsNumber&&(E.valueAsNumber=e.value):E.value=null}):"checkbox"===l?(u="checked",r=function(e){!e||i(e.value)?E.checked=!1:i(e.value)&&e.value!==E.checked&&(E.checked=e.value)}):"radio"===l?r=function(e){try{var n=e.value.toString();e&&E.value===n&&!0!==E.checked?E.checked=!0:e&&E.value!==n&&!0===E.checked&&(E.checked=!1)}catch(e){E.checked=!1}}:"date"!==l&&"month"!==l&&"week"!==l&&"time"!==l&&"datetime-local"!==l||(u="valueAsDate",r=function(e){e&&e.value instanceof Date?e.value instanceof Date&&e.value.getTime()!==E.valueAsDate.getTime()&&(E.valueAsDate=e.value):E.value=null}),o.to="del",r.to="set",w(E,p,v,s,function(){return n.value},[o,r],j);var h=["change","keyup","click"],d=function(t){var r=f(c(32,48));e.call(E,"this."+p+("["===n.value[0]?"":".")+n.value+" = "+r,{[r]:E[u]})};t(h,function(e){E.addEventListener(e,d)}),j.push(function(){t(h,function(e){E.removeEventListener(e,d)})})}});var C=function(e){e.stopPropagation(),t(j,function(e){e()})};return E.addEventListener(x,C),j.push(function(){E.removeEventListener(x,C)}),Object.setPrototypeOf([E],k)}}return function(e,n={},o="app"){var i,s,b=n[m];r(b)?(i=b(),s=n):(i=new function(){var e={},n={},o=(this.watch=function(t,o,i){var a,u;for(var c in r(o)?(a=t,u=o,i=i||{}):(a="**",u=t,i=o||{}),i)u.key=i.key;if(a.indexOf("*")>-1)var s=a.replace(/([!@#$%^&*(){}[\]\<\>:'"`\-_,./\\+-])/g,"\\$1").replace(/\\\*\\\*/g,".*").replace(/\\\*/,"[^:.]+"),f=(n[a]=n[a]||{regex:new RegExp(s),listeners:[]}).listeners;else f=e[a]=e[a]||[];return f.push(u),function(){f.splice(f.indexOf(u),1)}},{}),i=this.emit=function(r,i={}){for(var a=e[r]&&e[r].slice(),u=0;a&&u<a.length;u++)e[r].indexOf(a[u])>-1&&a[u](i,r);for(var c in n){var s=n[c];r.match(s.regex)&&t(s.listeners,function(e){e(i,r)})}return o[r]=i},a={},c=0,s=0,f=!1;this.async=function(e,n={}){f||(v(function(){var e=a;if(f=!1,a={},c=0,++s>3)s=0;else{var n=u(e);n.sort(function(n,t){return e[n].order>e[t].order?1:e[n].order<e[t].order?-1:0}),i("asyncstart",{payload:e,order:n}),t(n,function(n){i(n,e[n])}),i("asyncend",e),f||(s=0)}}),f=!0),a[e]=n,n.order=c+=1},this.last=function(e){return o[e]},this.next=function(e){return a[e]}},s=function e(n,o){var i,s=Object.getPrototypeOf(n);if(a(n)&&(s===Object.prototype&&(i=Object.create(p))||s===Array.prototype&&(i=Object.setPrototypeOf([],h)))){var v,b={[d]:function(e){return b[e]},[y]:k(y,"remap:"),[g]:k(g,"del:"),[m]:function(){return o}};function k(e,n){return function(){t(u(w),function(t){var i=w[t][e];r(i)&&i(),!o.next(n+b[t])&&o.async(n+b[t],{p:t})})}}var w=new Proxy(i,v={get:function(e,n){if(n in e||n in b){if(!(n in e)&&n in b)return b[n]}else w[n]={};return b.hasOwnProperty(n)||(b[n]=f(c(32,48))),o.emit("get",{value:b[n]}),void 0===e[n]||null===e[n]?"":e[n]},set:function(n,t,i){try{var u=Object.getPrototypeOf(i)}catch(e){return v.deleteProperty(n,t)}var s=Array.isArray(n);if(s){var l=n.length;b.hasOwnProperty("length")||(b.length=f(c(32,48)))}var p=n[t]&&n[t][y];return r(p)&&p(),i&&a(i)&&(u===Object.prototype||u===Array.prototype)?n[t]=e(i,o):n[t]=i,b.hasOwnProperty(t)||(b[t]=f(c(32,48))),o.async("set:"+b[t],{value:n[t],p:t}),s&&l!==n.length&&o.async("set:"+b.length,{value:n.length,p:t}),!0},deleteProperty:function(e,n){if(n in e){var t=e[n][y];return r(t)&&t(),o.async("del:"+b[n],{value:e[n],p:n}),delete b[n],delete e[n],!0}return!1}});return l(n,w),w}}(n,i)),i.async("set:");var k=N(e,s,i,o);return Object.defineProperty(k,o,{get:function(){return s},set:function(e){a(e)&&l(e,s)}}),k}}(function(s,sv={}){for(var k in sv)s="var "+k+" = sv."+k+";\n"+s;return eval(s)});