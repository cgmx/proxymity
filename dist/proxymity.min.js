"use strict";var proxymity=function(e){function t(e){return Array.prototype.slice.call(e||[])}function n(e,n){return t(e).forEach(n)}function r(e){return Object.getOwnPropertyNames(e)}function o(e,t){var n,r,o;return void 0===t||e>t?(r=e,n=t||0):(n=e,r=t),o=r-n,Math.round(Math.random()*(o+.9998)-.4999)+n}var i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";function a(e=16){for(var t=i[o(51)],n=1;n<e;n++)t+=i[o(62)];return t}function c(e,t){var o=r(t);for(var i in e)t[i]=e[i],o.splice(o.indexOf(i),1);n(o,function(e){delete t[e]})}var u=function(){var e=a(o(32,48)),t=!1,r=[];return window.addEventListener("message",function(i){if(i.data===e){i.stopPropagation();var c=r;e=a(o(32,48)),t=!1,r=[],n(c,function(e){e()})}}),function(n){t||(window.postMessage(e,"*"),t=!0),r.push(n)}}();var s={objectify:function(){if(Array.isArray(this))var e=[];else e={};var t=r(this);for(var n in t){var o=t[n];"object"==typeof this[o]&&this[o].objectify?e[o]=this[o].objectify():e[o]=this[o]}return e},stringify:function(){var e=t(arguments);return e.unshift(s.objectify.call(this)),JSON.stringify.apply(JSON,e)},toString:function(){return r(this).length?s.stringify.call(this):""}};s[Symbol.toPrimitive]=function(e){return"number"==e?r(this).length:"string"==e?s.toString.call(this):!!r(this).length};var f=Object.create(Array.prototype);n(r(s),function(e){f[e]=s[e]});var l=a(o(32,48)),p=a(o(32,48)),v=a(o(32,48));var y=/\{\:([\s\S]*?)\:\}/g;function h(t,n,r){r=r||t;var o=t.textContent;if(o.match(y))var i=n.watch("asyncstart",function(n){var i,a=!1;e:for(var c in n.payload)if("set:"===c.substring(0,4)){a=!0;break e}a&&(t.textContent=(i=r,o.replace(y,function(t,n){try{return e.call(i,n)}catch(e){console.warn("failed to render expression ["+n+"]",e)}})))});return function(){t.textContent=o,i&&i()}}var d=Object.create(Array.prototype);function g(e,t){n(e,function(e,n,r){t(e),g(e.childNodes,t)})}d.appendTo=function(e){if("string"==typeof e)return d.appendTo.call(this,document.querySelector(e));var t=e;return n(this,function(e){t.appendChild(e)}),this},d.detach=function(){return n(this,function(e){var t=e.parentElement;t&&t.removeChild(e)}),this};var m=a(o(32,48));function b(e,t,r,o){o.source.length;var i="set:"+e.last("get").value,a=function(i){if(void 0!==i){var a,c,u,s,f=o.outputList.indexOf(o.insertBefore),l=o.outputList.indexOf(o.insertAfter),p=o.outputList,v=o.insertBefore.parentNode,y=(a=p.slice(l+1,f),c=o.key,u=[],n(a,function(e){var t=e[c];u[t]=u[t]||[],u[t].push(e)}),u);if(y.length<o.source.length)for(;y.length!==o.source.length;){var h=o.elements.map(function(e){return e.cloneNode(!0)});g(h,function(e){Object.defineProperty(e,o.key,{configurable:!0,enumerable:!1,get:function(e){return e}.bind(e,y.length)})}),k(h,t,e,r),v&&n(h,function(e){v.insertBefore(e,o.insertBefore)}),o.onClone&&n(h,function(e){e instanceof HTMLElement&&o.onClone(e)}),p.splice.apply(p,[f,0].concat(h)),f+=h.length,y.push(h)}else if(y.length>o.source.length)for(;y.length!==o.source.length;){var d=y.pop();n(d,function(e){p.splice(p.indexOf(e),1),e.parentNode&&e.parentNode.removeChild(e)}),g(s=d,function(e){e.dispatchEvent(new CustomEvent(m))}),n(s,function(e){e.parentNode&&e.parentNode.removeChild(e)})}}};e.watch("asyncstart",function(e){e.payload.hasOwnProperty(i)&&a(e.payload[i])}),a(e.next(i)||e.last(i))}function k(r,i,u,s){if("string"==typeof r){var f=document.createElement("template");return f.innerHTML=r.trim(),k(f.content.childNodes,i,u,s)}if(r instanceof NodeList||r instanceof Array&&r.reduce(function(e,t){return e&&t instanceof Node},!0)){var p,v=[],y=t(r),g=function(e){if(p)throw new error("Impropert usage of key(string).in(array): key(string) cannot be nested on the same level");return p={key:e},g};return g.in=function(e){if(!p)throw new Error("Impropert usage of key(string).in(array): key(string) not called");if(p.source)throw new Error("Impropert usage of key(string).in(array): in(array) called before key");if(!Array.isArray(e)||!e[l])throw new Error("Impropert usage of key(string).in(array): in(array) is not provided with a proxified array");p.source=e,p.elements=[]},g.end=function(e){if(!(p&&p.key&&p.source&&p.elements&&p.elements.length))throw new Error("Impropert usage of key.end([onClone]): key(string).in(array) is not called properly prior to calling key.end([onClone])");p.outputList=y,p.insertBefore=p.elements.pop(),"function"==typeof e&&(p.onClone=e),v.push.apply(v,p.elements);for(var t=y.length-1;t>=0;t--)-1!==v.indexOf(y[t])&&y.splice(t,1);p.insertAfter=p.insertBefore.previousSibling,b(u,i,s,p),p=void 0},n(y,function(t){if(p&&p.elements&&p.elements.push(t),t instanceof Comment&&"foreach:"===t.textContent.trim().substr(0,8).toLowerCase()&&(k(t,i,u,s),e.call(t,t.textContent,{key:g}),p&&(!p.key||!p.source||!p.elements)))throw new Error("Improper usage of key(string).in(array): in(array) not called in conjunction with key")}),n(y,function(e){e[s]!==i&&k(e,i,u,s)}),Object.setPrototypeOf(y,d)}if(r instanceof Node){var w=r,O=[];if(Object.defineProperty(w,s,{configurable:!0,get:function(){return i},set:function(e){"object"==typeof e&&c(e,i)}}),O.push(function(){delete w[s]}),w instanceof CharacterData){var j=h(w,u);O.push(j)}else k(w.childNodes,i,u,s);n(w.attributes,function(t){var r="name"!==t.name&&h(t,u,w);if(r&&O.push(r),!("name"!==t.name||"INPUT"!==w.nodeName&"TEXTAREA"!==w.nodeName&"SELECT"!==w.nodeName)){var c=function(e){try{var t=e.value.toString();t!==w.value&&(w.value=t)}catch(e){w.value=null}},f=function(e){"object"==typeof e&&(w.value=null)},l="value",p=w.type.toLowerCase();"number"===p||"range"===p?(l="valueAsNumber",c=function(e){e&&"number"==typeof e.value?"number"==typeof e.value&&e.value!==w.valueAsNumber&&(w.valueAsNumber=e.value):w.value=null}):"checkbox"===p?(l="checked",c=function(e){e&&"boolean"==typeof e.value?"boolean"==typeof e.value&&e.value!==w.checked&&(w.checked=e.value):w.checked=!1}):"radio"===p?c=function(e){try{var t=e.value.toString();e&&w.value===t&&!0!==w.checked?w.checked=!0:e&&w.value!==t&&!0===w.checked&&(w.checked=!1)}catch(e){w.checked=!1}}:"date"!==p&&"month"!==p&&"week"!==p&&"time"!==p&&"datetime-local"!==p||(l="valueAsDate",c=function(e){e&&e.value instanceof Date?e.value instanceof Date&&e.value.getTime()!==w.valueAsDate.getTime()&&(w.valueAsDate=e.value):w.value=null}),f.to="del",c.to="set",function t(n,r,o,i,a,c,u){e.call(n,"this."+r+("["===a[0]?"":".")+a);var s=o.last("get").value,f={};for(var l in c){var p=c[l].to+":"+s;u.push(f[c[l].to]=o.watch(p,c[l])),c[l](o.next(p)||o.last(p))}u.push(f[s]=o.watch("remap:"+s,function(){for(var e in f){f[e]();var s=u.indexOf(f[e]);s>-1&&u.splice(s,1)}t(n,r,o,i,a,c,u)}))}(w,s,u,i,t.value,[f,c],O);var v=["change","keyup","propertychange","valuechange","input"],y=function(n){var r=a(o(32,48));e.call(w,"this."+s+("["===t.value[0]?"":".")+t.value+" = "+r,{[r]:w[l]})};n(v,function(e){w.addEventListener(e,y)}),O.push(function(){n(v,function(e){w.removeEventListener(e,y)})})}});var x=function(e){e.stopPropagation(),n(O,function(e){e()})};return w.addEventListener(m,x),O.push(function(){w.removeEventListener(m,x)}),Object.setPrototypeOf([w],d)}}return function(e,t={},i="app"){var y=new function(){var e={},t={},o=(this.watch=function(n,r,o){var i,a;for(var c in"function"==typeof r?(i=n,a=r,o=o||{}):(i="**",a=n,o=r||{}),o)a.key=o.key;if(i.indexOf("*")>-1)var u=i.replace(/([!@#$%^&*(){}[\]\<\>:'"`\-_,./\\+-])/g,"\\$1").replace(/\\\*\\\*/g,".*").replace(/\\\*/,"[^:.]+"),s=(t[i]=t[i]||{regex:new RegExp(u),listeners:[]}).listeners;else s=e[i]=e[i]||[];return s.push(a),function(){s.splice(s.indexOf(a),1)}},{}),i=this.emit=function(r,i={}){for(var a=0;e[r]&&a<e[r].length;a++)e[r][a](i,r);for(var c in t){var u=t[c];r.match(u.regex)&&n(u.listeners,function(e){e(i,r)})}return o[r]=i},a={},c=0,s=0,f=!1;this.async=function(e,t={}){f||(u(function(){var e=a;if(f=!1,a={},c=0,++s>3)s=0;else{var t=r(e);t.sort(function(t,n){return e[t].order>e[n].order?1:e[t].order<e[n].order?-1:0}),i("asyncstart",{payload:e,order:t}),n(t,function(t){i(t,e[t])}),i("asyncend",e),f||(s=0)}}),f=!0),a[e]=t,t.order=c+=1},this.last=function(e){return o[e]},this.next=function(e){return a[e]}};y.async("set:");var h=function e(t,i){var u,y=Object.getPrototypeOf(t);if("object"==typeof t&&(y===Object.prototype&&(u=Object.create(s))||y===Array.prototype&&(u=Object.setPrototypeOf([],f)))){var h={};function d(e,t){return function(){n(r(g),function(n){var r=g[n][e];"function"==typeof r&&r(),i.async(t+h[n],{p:n})})}}h[l]=function(e){return h[e]},h[p]=d(p,"remap:"),h[v]=d(v,"del:");var g=new Proxy(u,{get:function(e,t){if(t in e||t in h){if(!(t in e)&&t in h)return h[t]}else g[t]={};return h.hasOwnProperty(t)||(h[t]=a(o(32,48))),i.emit("get",{value:h[t]}),void 0===e[t]||null===e[t]?"":e[t]},set:function(t,n,r){var c=Object.getPrototypeOf(r),u=Array.isArray(t);if(u){var s=t.length;h.hasOwnProperty("length")||(h.length=a(o(32,48)))}var f=t[n]&&t[n][p];return"function"==typeof f&&f(),!r||"object"!=typeof r||c!==Object.prototype&&c!==Array.prototype?t[n]=r:t[n]=e(r,i),h.hasOwnProperty(n)||(h[n]=a(o(32,48))),i.async("set:"+h[n],{value:t[n],p:n}),u&&s!==t.length&&i.async("set:"+h.length,{value:t.length,p:n}),!0},deleteProperty:function(e,t){if(t in e){var n=e[t][p];return"function"==typeof n&&n(),i.async("del:"+h[t],{value:e[t],p:t}),delete h[t],delete e[t]}return!1}});return c(t,g),g}}(t,y),d=k(e,h,y,i);return Object.defineProperty(d,i,{get:function(){return h},set:function(e){"object"==typeof e&&c(e,h)}}),d}}(function(script,sv={}){for(var key in sv)script="var "+key+" = sv."+key+";\n"+script;return eval(prepend+script)});